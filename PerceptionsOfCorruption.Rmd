---
title: "PerceptionsOfCorruption"
author: "Anna MacFarlane"
date: "10/26/2020"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(plyr) #package for join command
library(broom)

knitr::opts_chunk$set(echo = TRUE)
report_2018 <- read_csv("data/2018.csv") %>% 
  mutate(year = "2018") %>% 
  mutate(`Perceptions of corruption` = as.numeric(`Perceptions of corruption`))
report_2019 <- read_csv("data/2019.csv") %>% 
  mutate(year = "2019")

worldhappiness <- full_join(report_2018, report_2019)
```

### Organizing data
```{r data}
corruption <- worldhappiness %>% 
  filter(! is.na(`Perceptions of corruption`)) %>% 
  select(Score, `Perceptions of corruption`, year)

year2019 <- corruption %>% 
  filter(year == "2019")
year2018 <- corruption %>% 
  filter(year == "2018")
```

### Correlational stats

```{r correlations}
corruption %>% 
  summarize(r_overall = cor(Score, `Perceptions of corruption`))

year2019 %>% 
  summarize(r_2019 = cor(Score, `Perceptions of corruption`))

year2018 %>% 
  summarize(r_2018 = cor(Score, `Perceptions of corruption`))

```


### Linear model and 95% confidence interval 

```{r linear-model-corrupt, message = FALSE}
# Linear model for relationship between perceptions of corruption score and overall happiness score
m_corrupt <- lm(Score ~ `Perceptions of corruption`, data = worldhappiness)

m_corrupt %>%
  tidy() %>%
  select(term, estimate) 


# Visualization of linear model
ggplot(data = corruption, aes(x = `Perceptions of corruption`,
                              y = Score)) + 
  geom_point(size = 0.8) + 
  geom_smooth(method = lm, color = "blue", size = 0.5) +
  labs(title = "Linear model for relationship between perceptions of corruption
and overall happiness score",
       subtitle = "Moderate, positive assocation",
       x = "Perceptions of corruption score",
       y = "Overall happiness score")

#Confidence interval for linear model above 
broom::confint_tidy(m_corrupt, conf.level = 0.95) %>% 
  slice(2)

```
Overall happiness score = 4.873 + 4.616(Perceptions of corruption)

The confidence interval generated is about (3.416, 5.817). We are 95% confident that for every additional point increase in the perceptions of corruption, the overall happiness score with increase, on average, by 4.616 points. 


### Hypothesis test for association

** Note: Is this dumb to do because obviously they're associated because they used it to calculate the overall happiness score?

This test will be evaluated at the $\alpha = 0.05$ level.

Null hypothesis: There is no association between the perceptions of corruption and the overall happiness score. They are independent.

Alternative hypothesis: There is an association between the perceptions of corruption and the overall happiness score. They are not independent.


```{r association}
tidy(m_corrupt)
```
Considering that our p-value is less that $\alpha =$ 0.05, we can reject the null hypothesis. There is statistically significant evidence to suggest that there is an assocation between perceptions of corruption and the overall happiness score. They are not independent. 


### Multiple regression for all the factors we are evaluating
